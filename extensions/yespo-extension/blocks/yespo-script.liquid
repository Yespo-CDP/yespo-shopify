{%- assign yespo_script = shop.metafields['$app'].yespo-script -%}
{%- assign yespo_web_push_script = shop.metafields['$app'].yespo-web-push-script -%}
{%- assign yespo_web_tracking_enabled = shop.metafields['$app'].web-tracking-enabled -%}
{%- assign yespo_app_host = shop.metafields['$app'].yespo-app-host -%}

{% if yespo_script != blank %}
  {{ yespo_script }}
{% endif %}

{% if yespo_web_push_script != blank %}
  {{ yespo_web_push_script }}
{% endif %}

<script>
console.log({{ yespo_app_host }})
</script>

<script id="data" type="application/json">
  {
    "host": {{ yespo_app_host | json }},
    "pageTemplate": {{ template.name | json }},
    "domain":  {{ shop.domain | json }},
    "product": {{ product | json }},
    "customer":
      {% if customer %}
        {
          "id": {{ customer.id | json }},
          "email": {{ customer.email | json }},
          "firstName": {{ customer.first_name | json }},
          "lastName": {{ customer.last_name | json }},
          "phone": {{ customer.phone | json }}
        }
      {% else %}
        null
      {% endif %}
  }
</script>

{% if yespo_web_tracking_enabled %}
  <script>
    console.log('ENABLED')
  </script>
  <script src="{{ "web-tracking.js" | asset_url }}" defer></script>
{% endif %}

{% schema %}
{
  "name": "Yespo script",
  "target": "head",
}
{% endschema %}

